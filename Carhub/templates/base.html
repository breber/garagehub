<!DOCTYPE html>

<html>
<head>
<title>Carhub</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<link type="text/css" href="/static/css/bootstrap.min.css" rel="stylesheet" />
<link type="text/css" href="/static/css/bootstrap-responsive.min.css" rel="stylesheet" />
<link type="text/css" href="/static/css/auto.css" rel="stylesheet" />
{% block externalcss %}{% endblock %}
<script type="text/javascript" src="/static/js/ext/jquery.min.js"></script>
<script type="text/javascript" src="/static/js/ext/bootstrap.min.js"></script>
<script type="text/javascript" src="/static/js/analytics.js"></script>
<script type="text/javascript" src="/static/js/vehiclecommon.js"></script>
</head>

<body>
  <div class="navbar navbar-inverse navbar-fixed-top">
    <div class="navbar-inner">
      <div class="container">
        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </a>

        <a class="brand profile-link" href="/"><img src="/static/img/carhub_logo.png" class="profile-image" height="48" width="auto"></a>

        <div class="nav-collapse collapse">
          <ul class="nav">
            {% if user %}
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">Garage <b class="caret hidden-phone"></b></a>
              <ul class="dropdown-menu">
              	{% for v in uservehicles %}
                <li><a href="/vehicle/{{ v.key.id }}">{{ v.name }}</a></li> 
                {% endfor %}
                {% if uservehicles %}
                <li class="divider"></li> 
                {% endif %}
                <li><a href="#addVehicle" data-toggle="modal"><i class="icon-plus"></i> Add Vehicle</a></li>
              </ul>
            </li>
            {% endif %}

            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">Tools <b class="caret hidden-phone"></b></a>
              <ul class="dropdown-menu">
                <li><a href="/tools/gasprices">Gas Prices</a></li>
                <li><a href="/tools/tripplanner">Trip Planner</a></li>
              </ul>
            </li>
            
            {% if user %}
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">Notifications 
              	{% if newNotifications %}
              	<span class="badge badge-important">{{ newNotifications }}</span> 
              	{% endif %}
              	<b class="caret hidden-phone"></b></a>
              <ul class="dropdown-menu">
              	{% for notif in dateNotifications %}
              	<li><a href="/notifications/clear">
          		  {{ notif.vehicleName }}: Need {{ notif.category }} by {{ notif.date }}
              	</a></li>
              	{% endfor %}
              	{% for notif in mileNotifications %}
              	<li><a href="/notifications/clear">
          		  {{ notif.vehicleName }}: Need {{ notif.category }} at {{ notif.mileage }} miles
              	</a></li>
              	{% endfor %}
                {% if totalNotifications %}
                <li class="divider"></li>
                {% endif %}
                <li><a href="/notifications/add"><i class="icon-plus"></i> Add Notification</a></li>
                <li><a href="/notifications"><i class="icon-eye-open"></i> View Notifications</a></li>
              </ul>
            </li>
            {% endif %}
          </ul>

          <ul class="nav pull-right">
            {% if not user %}
            <li><a href="{{ loginurl }}">Login</a></li>
            {% endif %} 
            {% if user %}
            <ul class="nav">
              <li class="dropdown">
                <a href="#" class="dropdown-toggle profile-link" data-toggle="dropdown">
                  <img src="{{ user.profilePic }}" class="hidden-phone profile-image"/> {{ user.username }} <b class="caret hidden-phone"></b>
                </a>
                <ul class="dropdown-menu">
                  {% if user.isAdmin %}
                  <li><a href="/admin/">Admin</a></li>
                  {% endif %}
                  <li><a href="/settings">Settings</a></li>
                  <li class="divider"></li>
                  <li><a href="{{ logouturl }}">Logout</a></li>
                </ul>
              </li>
            </ul>
            {% endif %}
          </ul>
        </div>
      </div>
    </div>
  </div>

  <div id="wrap">
    <div class="container-fluid center-block top-margin">
      <div id="content">{% block content %}{% endblock %}</div>
      <div id="push"></div>
    </div>
  </div>

  <div id="footer">
    <div class="container">
      <p>Copyright (c) {{ currentYear }}</p>
    </div>
  </div>

  {% if user %}
  <div id="addVehicle" class="modal hide fade">
    <div class="modal-header">
      <button type="button" class="close" data-dismiss="modal">x</button>
      <h3>Add Vehicle</h3>
    </div>
    <div class="modal-body">
      <form action="/vehicle/add" method="post" id="saveForm">
        <div>
          <label for="make">Make:</label>
          <select id="makes" name="make">
            <option>Select a make</option>
          </select>
        </div>
        <div>
          <label for="model">Model:</label>
          <select id="models" name="model">
            <option>Select a model</option>
          </select>
        </div>
        <div>
          <label for="year">Year:</label>
          <select id="years" name="year">
            <option>Select a year</option>
          </select>
        </div>
        <div>
          <label for="color">Color:</label>
          <input id="color" type="text" name="color" />
        </div>
        <div>
          <label for="licensePlates">License Plates:</label>
          <input id="licensePlates" type="text" name="licensePlates" />
        </div>
      </form>
    </div>
    <div class="modal-footer">
      <a href="#" class="btn" data-dismiss="modal">Close</a>
      <input type="submit" class="btn btn-primary" autofocus="autofocus" form="saveForm"></input>
    </div>
  </div>
  <script type="text/javascript" src="/static/js/addvehicle.js"></script>
  {% endif %}

  {% block externaljs %}{% endblock %}
</body>
</html>